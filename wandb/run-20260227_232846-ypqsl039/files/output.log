
============================================================
PHASE 4: DYNAMIC AI SETUP DISCOVERY (MORL-SB-TRPO)
============================================================
[VehicleDynamics] H_net scale loaded: 103.31 J
[Physics Engine] Loaded pre-trained H_net weights.
[Physics Engine] Loaded pre-trained R_net weights.

[MORL-SB-TRPO] Initialising Pareto Policy Ensemble…
[SB-TRPO] Compiling 46-DOF physics gradients via XLA…
   [DIAG] Soft grip: 1.3541 G | Hard grip: 1.3127 G
[SB-TRPO] Testing gradient flow through objective…
   Grip gradient norm : 0.311098
   Grip gradient max  : 0.247936
   [OK] Gradient flow confirmed — TRPO is active.
   [DIAG] Expected per-step KL at lr=5e-3, σ=0.368: ~0.000739 nats  (threshold=0.0005)
   [OK] Trust region will activate from first step.
[SB-TRPO] Running feasibility pre-check…
   [SB-TRPO] i=   0 | Safe: 13/20 | Valid: 13/20 | Grip: 1.3639 G | Stab: -0.3666 | HV: 1.382086 | KL: 0.000000
   [SB-TRPO] i=  20 | Safe: 14/20 | Valid: 14/20 | Grip: 1.3881 G | Stab: -0.3451 | HV: 1.483122 | KL: -0.000000
   [SB-TRPO] i=  40 | Safe: 14/20 | Valid: 14/20 | Grip: 1.3774 G | Stab: -0.3281 | HV: 1.487017 | KL: -0.000000
   [SB-TRPO] i=  60 | Safe: 13/20 | Valid: 13/20 | Grip: 1.3912 G | Stab: -0.3596 | HV: 1.494848 | KL: -0.000000
   [SB-TRPO] i=  80 | Safe: 12/20 | Valid: 12/20 | Grip: 1.3785 G | Stab: -0.3663 | HV: 1.500811 | KL: -0.000000
   [SB-TRPO] i= 100 | Safe: 11/20 | Valid: 11/20 | Grip: 1.3819 G | Stab: -0.4076 | HV: 1.501962 | KL: -0.000000
   [SB-TRPO] i= 120 | Safe: 12/20 | Valid: 12/20 | Grip: 1.3725 G | Stab: -0.3830 | HV: 1.501962 | KL: -0.000000
   [SB-TRPO] i= 140 | Safe: 11/20 | Valid: 11/20 | Grip: 1.3639 G | Stab: -0.3403 | HV: 1.505433 | KL: -0.000000
   [SB-TRPO] i= 160 | Safe: 9/20 | Valid: 9/20 | Grip: 1.3761 G | Stab: -0.3541 | HV: 1.505433 | KL: -0.000000
   [SB-TRPO] i= 180 | Safe: 10/20 | Valid: 10/20 | Grip: 1.3854 G | Stab: -0.3736 | HV: 1.505433 | KL: -0.000000
   [SB-TRPO] i= 200 | Safe: 11/20 | Valid: 11/20 | Grip: 1.3750 G | Stab: -0.3714 | HV: 1.505433 | KL: -0.000000
   [SB-TRPO] i= 220 | Safe: 12/20 | Valid: 12/20 | Grip: 1.3699 G | Stab: -0.3718 | HV: 1.505484 | KL: -0.000000
   [SB-TRPO] i= 240 | Safe: 10/20 | Valid: 10/20 | Grip: 1.3818 G | Stab: -0.3501 | HV: 1.505484 | KL: -0.000000
   [SB-TRPO] i= 260 | Safe: 10/20 | Valid: 10/20 | Grip: 1.3603 G | Stab: -0.3441 | HV: 1.517060 | KL: -0.000000
   [SB-TRPO] i= 280 | Safe: 10/20 | Valid: 10/20 | Grip: 1.3787 G | Stab: -0.3668 | HV: 1.517060 | KL: -0.000000
   [SB-TRPO] i= 300 | Safe: 9/20 | Valid: 9/20 | Grip: 1.3702 G | Stab: -0.3478 | HV: 1.517060 | KL: -0.000000
   [SB-TRPO] i= 320 | Safe: 8/20 | Valid: 8/20 | Grip: 1.3813 G | Stab: -0.3775 | HV: 1.517060 | KL: -0.000000
   [SB-TRPO] i= 340 | Safe: 9/20 | Valid: 9/20 | Grip: 1.3742 G | Stab: -0.3669 | HV: 1.517060 | KL: -0.000000
   [SB-TRPO] i= 360 | Safe: 8/20 | Valid: 8/20 | Grip: 1.3547 G | Stab: -0.3552 | HV: 1.517060 | KL: -0.000000
   [SB-TRPO] i= 380 | Safe: 8/20 | Valid: 8/20 | Grip: 1.3805 G | Stab: -0.3676 | HV: 1.517157 | KL: -0.000000

[MORL-SB-TRPO] Pareto front discovery complete:
         k_f          k_r       arb_f       arb_r         c_f         c_r     h_cg  brake_bias_f  Lat_G_Score  Stability_Overshoot  Generation
32118.730469 30629.472656 1028.645264  392.957336 1704.336182 3105.899902 0.278515      0.639009     1.399571             0.950289          53
31203.000000 31511.853516  983.382629  418.478088 1766.414551 3249.659180 0.276770      0.642158     1.398011             1.703727          24
32854.625000 29941.978516 1062.815674  372.920105 1675.789551 3028.991211 0.279919      0.637817     1.396974             2.324449          72
31436.001953 31298.595703  995.265991  411.849243 1743.308838 3199.572266 0.277194      0.640878     1.395342             2.725656          33
24284.074219 28571.625000  350.034637 1811.039917 4709.979492 3505.807861 0.279548      0.700895     1.392785             7.628226         229
23843.980469 28802.298828  337.236023 1816.063843 4820.393555 3621.236328 0.278638      0.705490     1.388764             8.781397         190
23654.746094 28884.828125  331.759888 1818.474976 4869.828125 3677.208008 0.278291      0.707544     1.387932            10.791189         173
22857.636719 28127.035156  320.685364 1824.038818 5227.760742 4194.136230 0.277707      0.722616     1.380329            11.341076          39
22839.685547 28102.441406  320.497528 1824.127563 5236.053223 4207.841309 0.277698      0.722917     1.377546            11.738371          36
23231.410156 28259.578125  328.527069 1819.813354 5115.625977 4014.333496 0.278212      0.718268     1.377499            12.648156          81
22863.722656 28135.015625  320.745758 1824.012573 5225.118164 4189.689453 0.277710      0.722515     1.377436            13.593528          40
22658.095703 27994.412109  316.975098 1826.183838 5298.355469 4319.789062 0.277459      0.725233     1.366394            14.043880          14
23098.837891 28267.123047  324.492767 1821.566528 5148.095215 4064.625000 0.277974      0.719496     1.360639            14.564532          69
22722.878906 27993.105469  318.677826 1825.182007 5281.669922 4288.484375 0.277580      0.724630     1.357612            14.760489          20

[Success] Pareto array saved to /home/alexr/FS_Driver_Setup_Optimizer/morl_pareto_front.csv
