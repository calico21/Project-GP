
============================================================
PHASE 4: DYNAMIC AI SETUP DISCOVERY (MORL-SB-TRPO)
============================================================
[VehicleDynamics] H_net scale loaded: 103.31 J

[MORL-SB-TRPO] Initialising Pareto Policy Ensemble…
[SB-TRPO] Compiling 46-DOF physics gradients via XLA…
   [DIAG] Soft grip: 1.5290 G | Hard grip: 1.4838 G
[SB-TRPO] Testing gradient flow through objective…
   Grip gradient norm : 0.531407
   [OK] Gradient flow confirmed — TRPO is active.
   [DIAG] Entropy bonus: coeff=0.0050 | At log_std=-1.0: Σ contribution = -0.0400 G-equiv per member
   [DIAG] At log_std=-3.0 (collapsed): -0.1200 G-equiv — resists collapse.
   [DIAG] KL: per-step≈0.000739, 10-step lag≈0.007389 (threshold=0.0005)
   [OK] Trust region activates after 10-iter burn-in.
   [Fix H] Chebyshev omegas: 8/20 members in high-grip region [0.7, 1.0] (vs 6 with linear spacing).
   [Fix B] Stability_Overshoot cap: 5.0 — artefact setups (k_f at boundary) will be filtered from archive.
   [Fix G] Population restart: every 200 iters, bottom 5 members reinitialised to random logit-space.
[SB-TRPO] Running feasibility pre-check…
   [SB-TRPO] i=   0 | Safe: 13/20 | Valid: 9/20 | Grip: 1.5113 G | Stab: -0.5036 | HV: 1.445910 | KL: 0.000000 | log_std: -0.998 [+6 artefacts filtered] [burn-in]
   [SB-TRPO] i=  20 | Safe: 15/20 | Valid: 10/20 | Grip: 1.5475 G | Stab: -0.5699 | HV: 1.653794 | KL: 0.008913 | log_std: -0.999 [+7 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i=  40 | Safe: 15/20 | Valid: 11/20 | Grip: 1.5643 G | Stab: -0.4135 | HV: 1.658770 | KL: 0.007826 | log_std: -0.998 [+6 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i=  60 | Safe: 13/20 | Valid: 7/20 | Grip: 1.5414 G | Stab: -0.4630 | HV: 1.663063 | KL: 0.006540 | log_std: -0.998 [+7 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i=  80 | Safe: 13/20 | Valid: 8/20 | Grip: 1.5756 G | Stab: -0.4619 | HV: 1.674244 | KL: 0.005551 | log_std: -0.998 [+5 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 100 | Safe: 14/20 | Valid: 11/20 | Grip: 1.5270 G | Stab: -0.3777 | HV: 1.686274 | KL: 0.004579 | log_std: -0.998 [+5 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 120 | Safe: 13/20 | Valid: 8/20 | Grip: 1.5193 G | Stab: -0.4718 | HV: 1.686274 | KL: 0.005189 | log_std: -0.997 [+6 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 140 | Safe: 13/20 | Valid: 8/20 | Grip: 1.5509 G | Stab: -0.5039 | HV: 1.687768 | KL: 0.005098 | log_std: -0.998 [+6 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 160 | Safe: 11/20 | Valid: 7/20 | Grip: 1.4794 G | Stab: -0.5172 | HV: 1.697134 | KL: 0.004642 | log_std: -1.000 [+4 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 180 | Safe: 13/20 | Valid: 12/20 | Grip: 1.4999 G | Stab: -0.5027 | HV: 1.697134 | KL: 0.005409 | log_std: -1.000 [+3 artefacts filtered] [TR active] [10-step lag]
   [FIX G] i=200: restarted bottom 5 members (grips: [np.float32(1.3404434), np.float32(1.398163), np.float32(1.4027337), np.float32(1.4314892), np.float32(1.4385636)])
   [SB-TRPO] i= 200 | Safe: 8/20 | Valid: 7/20 | Grip: 1.5277 G | Stab: -0.4276 | HV: 1.697287 | KL: 20.388737 | log_std: -0.999 [+3 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 220 | Safe: 10/20 | Valid: 8/20 | Grip: 1.5320 G | Stab: -0.6291 | HV: 1.700460 | KL: 0.005691 | log_std: -1.001 [+4 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 240 | Safe: 9/20 | Valid: 8/20 | Grip: 1.5444 G | Stab: -0.4559 | HV: 1.702441 | KL: 0.006713 | log_std: -1.002 [+4 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 260 | Safe: 9/20 | Valid: 7/20 | Grip: 1.4925 G | Stab: -0.5980 | HV: 1.702441 | KL: 0.007412 | log_std: -1.002 [+3 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 280 | Safe: 10/20 | Valid: 9/20 | Grip: 1.5019 G | Stab: -0.6256 | HV: 1.702441 | KL: 0.007499 | log_std: -1.003 [+1 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 300 | Safe: 11/20 | Valid: 9/20 | Grip: 1.5302 G | Stab: -0.3917 | HV: 1.702441 | KL: 0.007746 | log_std: -1.005 [+3 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 320 | Safe: 9/20 | Valid: 6/20 | Grip: 1.5054 G | Stab: -0.5674 | HV: 1.702441 | KL: 0.007742 | log_std: -1.006 [+6 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 340 | Safe: 8/20 | Valid: 5/20 | Grip: 1.5019 G | Stab: -0.4556 | HV: 1.702441 | KL: 0.007097 | log_std: -1.007 [+3 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 360 | Safe: 9/20 | Valid: 8/20 | Grip: 1.5203 G | Stab: -0.5483 | HV: 1.702441 | KL: 0.007681 | log_std: -1.009 [+1 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 380 | Safe: 8/20 | Valid: 7/20 | Grip: 1.5135 G | Stab: -0.5632 | HV: 1.702441 | KL: 0.007546 | log_std: -1.009 [+1 artefacts filtered] [TR active] [10-step lag]
   [FIX G] i=400: restarted bottom 5 members (grips: [np.float32(1.4426839), np.float32(1.4453095), np.float32(1.4484884), np.float32(1.451403), np.float32(1.4542536)])
   [SB-TRPO] i= 400 | Safe: 10/20 | Valid: 10/20 | Grip: 1.5178 G | Stab: -0.5459 | HV: 1.702441 | KL: 24.990921 | log_std: -1.005 [+2 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 420 | Safe: 11/20 | Valid: 8/20 | Grip: 1.5238 G | Stab: -0.4494 | HV: 1.702441 | KL: 0.008698 | log_std: -1.007 [+4 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 440 | Safe: 11/20 | Valid: 10/20 | Grip: 1.5087 G | Stab: -0.4627 | HV: 1.702441 | KL: 0.007191 | log_std: -1.008 [+2 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 460 | Safe: 11/20 | Valid: 10/20 | Grip: 1.5574 G | Stab: -0.3950 | HV: 1.704432 | KL: 0.008980 | log_std: -1.009 [+2 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 480 | Safe: 10/20 | Valid: 8/20 | Grip: 1.5278 G | Stab: -0.5660 | HV: 1.704432 | KL: 0.005985 | log_std: -1.009 [+3 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 500 | Safe: 8/20 | Valid: 7/20 | Grip: 1.5204 G | Stab: -0.5888 | HV: 1.704432 | KL: 0.005928 | log_std: -1.011 [+2 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 520 | Safe: 8/20 | Valid: 7/20 | Grip: 1.5279 G | Stab: -0.4476 | HV: 1.710919 | KL: 0.005880 | log_std: -1.012 [+2 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 540 | Safe: 8/20 | Valid: 6/20 | Grip: 1.5208 G | Stab: -0.5847 | HV: 1.711513 | KL: 0.007041 | log_std: -1.012 [+2 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 560 | Safe: 10/20 | Valid: 9/20 | Grip: 1.5397 G | Stab: -0.4348 | HV: 1.711513 | KL: 0.006824 | log_std: -1.013 [+1 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 580 | Safe: 9/20 | Valid: 9/20 | Grip: 1.5302 G | Stab: -0.5953 | HV: 1.711513 | KL: 0.006833 | log_std: -1.014 [+2 artefacts filtered] [TR active] [10-step lag]
   [FIX G] i=600: restarted bottom 5 members (grips: [np.float32(1.4105487), np.float32(1.4232918), np.float32(1.4297643), np.float32(1.4384023), np.float32(1.4407421)])
   [SB-TRPO] i= 600 | Safe: 9/20 | Valid: 7/20 | Grip: 1.5222 G | Stab: -1.0225 | HV: 1.711513 | KL: 31.673527 | log_std: -1.008 [+2 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 620 | Safe: 10/20 | Valid: 9/20 | Grip: 1.5168 G | Stab: -1.3389 | HV: 1.711513 | KL: 0.006688 | log_std: -1.011 [+2 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 640 | Safe: 10/20 | Valid: 9/20 | Grip: 1.5288 G | Stab: -1.2697 | HV: 1.711513 | KL: 0.007802 | log_std: -1.013 [+1 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 660 | Safe: 10/20 | Valid: 8/20 | Grip: 1.5337 G | Stab: -0.8668 | HV: 1.711513 | KL: 0.008236 | log_std: -1.014 [+2 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 680 | Safe: 9/20 | Valid: 9/20 | Grip: 1.5250 G | Stab: -1.1875 | HV: 1.711513 | KL: 0.008423 | log_std: -1.014 [TR active] [10-step lag]
   [SB-TRPO] i= 700 | Safe: 8/20 | Valid: 6/20 | Grip: 1.5025 G | Stab: -1.4370 | HV: 1.711513 | KL: 0.008530 | log_std: -1.016 [+3 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 720 | Safe: 8/20 | Valid: 7/20 | Grip: 1.5478 G | Stab: -1.5202 | HV: 1.712068 | KL: 0.008683 | log_std: -1.017 [+1 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 740 | Safe: 9/20 | Valid: 8/20 | Grip: 1.5157 G | Stab: -1.6764 | HV: 1.712068 | KL: 0.008796 | log_std: -1.018 [+2 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 760 | Safe: 10/20 | Valid: 9/20 | Grip: 1.5621 G | Stab: -1.5656 | HV: 1.712068 | KL: 0.008935 | log_std: -1.019 [+2 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 780 | Safe: 8/20 | Valid: 7/20 | Grip: 1.5238 G | Stab: -1.8357 | HV: 1.712068 | KL: 0.008513 | log_std: -1.020 [+1 artefacts filtered] [TR active] [10-step lag]
   [FIX G] i=800: restarted bottom 5 members (grips: [np.float32(1.3868678), np.float32(1.402772), np.float32(1.4046446), np.float32(1.4062321), np.float32(1.4246252)])
   [SB-TRPO] i= 800 | Safe: 9/20 | Valid: 9/20 | Grip: 1.5348 G | Stab: -1.4589 | HV: 1.712068 | KL: 31.890924 | log_std: -1.021 [+3 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 820 | Safe: 9/20 | Valid: 9/20 | Grip: 1.5061 G | Stab: -1.3407 | HV: 1.712068 | KL: 0.007138 | log_std: -1.023 [+2 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 840 | Safe: 9/20 | Valid: 7/20 | Grip: 1.5396 G | Stab: -1.6461 | HV: 1.712068 | KL: 0.009646 | log_std: -1.025 [+5 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 860 | Safe: 8/20 | Valid: 8/20 | Grip: 1.5345 G | Stab: -1.8852 | HV: 1.712068 | KL: 0.009547 | log_std: -1.027 [+2 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 880 | Safe: 8/20 | Valid: 8/20 | Grip: 1.5195 G | Stab: -1.4082 | HV: 1.712068 | KL: 0.008665 | log_std: -1.028 [+3 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 900 | Safe: 7/20 | Valid: 7/20 | Grip: 1.5500 G | Stab: -1.0309 | HV: 1.712068 | KL: 0.009017 | log_std: -1.030 [TR active] [10-step lag]
   [SB-TRPO] i= 920 | Safe: 9/20 | Valid: 9/20 | Grip: 1.5497 G | Stab: -1.6056 | HV: 1.712068 | KL: 0.008351 | log_std: -1.031 [TR active] [10-step lag]
   [SB-TRPO] i= 940 | Safe: 9/20 | Valid: 9/20 | Grip: 1.5301 G | Stab: -1.7329 | HV: 1.712068 | KL: 0.008313 | log_std: -1.033 [+2 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 960 | Safe: 7/20 | Valid: 7/20 | Grip: 1.5253 G | Stab: -1.6581 | HV: 1.712068 | KL: 0.007752 | log_std: -1.034 [+2 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 980 | Safe: 6/20 | Valid: 5/20 | Grip: 1.5391 G | Stab: -1.3574 | HV: 1.712068 | KL: 0.007273 | log_std: -1.036 [+3 artefacts filtered] [TR active] [10-step lag]

[MORL-SB-TRPO] Pareto front discovery complete:
         k_f          k_r       arb_f       arb_r         c_f         c_r     h_cg  brake_bias_f  Lat_G_Score  Stability_Overshoot  Generation
30885.228516 31892.695312  996.264832  520.192993 2248.237305 3627.728516 0.275352      0.646104     1.576689             2.263809          46
31089.085938 31733.583984  997.908997  519.358398 2240.289551 3611.728027 0.275434      0.646241     1.575583             2.720112          80
42897.992188 45736.476562 1366.072632 1494.351074 4501.866699 3106.515137 0.259535      0.601556     1.569269             3.585699         961
42872.734375 45765.718750 1367.016357 1494.920532 4496.295898 3117.264893 0.259479      0.600626     1.566222             4.418861         952
42483.406250 45874.367188 1365.643799 1495.175049 4538.428711 3152.462891 0.259498      0.600930     1.560330             4.517946         827
42927.777344 45759.687500 1369.344849 1493.142822 4493.428223 3113.875000 0.259455      0.600824     1.557217             4.870910         970
43293.207031 33881.804688 1780.209839  607.750122 2907.454102 3265.543945 0.280388      0.558593     1.553220             4.961654         963
39334.621094 39566.531250 1064.976318 1855.086914 4028.715820 3837.862305 0.281010      0.611451     1.544492             4.965996         451
41443.820312 45854.902344 1367.807739 1492.837402 4678.164062 3277.157227 0.259458      0.600780     1.543346             4.989591         533
38984.804688 39837.085938 1064.807129 1853.982544 4046.168945 3853.038574 0.281063      0.611427     1.519299             4.993786         388
23871.015625 37705.371094  454.178040 1387.546265 3492.865723 3236.173828 0.282222      0.635498     1.474534             4.995888          49
21496.304688 41278.242188  484.579773 1778.269531 4017.987061 3084.837891 0.308286      0.470987     1.372305             4.998728          85

[Success] Pareto array saved to /home/alexr/FS_Driver_Setup_Optimizer/morl_pareto_front.csv
