
============================================================
PHASE 4: DYNAMIC AI SETUP DISCOVERY (MORL-SB-TRPO)
============================================================
[VehicleDynamics] H_net scale loaded: 103.31 J
[Physics Engine] Loaded pre-trained H_net weights.
[Physics Engine] Loaded pre-trained R_net weights.

[MORL-SB-TRPO] Initialising Pareto Policy Ensemble…
[SB-TRPO] Compiling 46-DOF physics gradients via XLA…
   [DIAG] Soft grip: 1.3541 G | Hard grip: 1.3127 G
[SB-TRPO] Testing gradient flow through objective…
   Grip gradient norm : 0.311098
   Grip gradient max  : 0.247936
   [OK] Gradient flow confirmed — TRPO is active.
   [DIAG] Per-step KL at lr=5e-3, σ=0.368: ~0.000739 nats
   [DIAG] Accumulated KL over 10-step lag: ~0.007389 nats  (threshold=0.0005)
   [OK] Trust region will activate reliably after 10-iteration burn-in.
[SB-TRPO] Running feasibility pre-check…
   [SB-TRPO] i=   0 | Safe: 13/20 | Valid: 13/20 | Grip: 1.3639 G | Stab: -0.3666 | HV: 1.382086 | KL: 0.000000 [burn-in]
   [SB-TRPO] i=  20 | Safe: 15/20 | Valid: 15/20 | Grip: 1.3862 G | Stab: -0.3463 | HV: 1.479837 | KL: 0.002376 [TR active] [10-step lag]
   [SB-TRPO] i=  40 | Safe: 15/20 | Valid: 15/20 | Grip: 1.3931 G | Stab: -0.3348 | HV: 1.481060 | KL: 0.002245 [TR active] [10-step lag]
   [SB-TRPO] i=  60 | Safe: 13/20 | Valid: 13/20 | Grip: 1.3862 G | Stab: -0.3632 | HV: 1.488784 | KL: 0.002361 [TR active] [10-step lag]
   [SB-TRPO] i=  80 | Safe: 13/20 | Valid: 13/20 | Grip: 1.3980 G | Stab: -0.3669 | HV: 1.491096 | KL: 0.002313 [TR active] [10-step lag]
   [SB-TRPO] i= 100 | Safe: 14/20 | Valid: 14/20 | Grip: 1.3735 G | Stab: -0.4284 | HV: 1.491819 | KL: 0.002359 [TR active] [10-step lag]
   [SB-TRPO] i= 120 | Safe: 13/20 | Valid: 13/20 | Grip: 1.3653 G | Stab: -0.3880 | HV: 1.491819 | KL: 0.002976 [TR active] [10-step lag]
   [SB-TRPO] i= 140 | Safe: 13/20 | Valid: 13/20 | Grip: 1.3792 G | Stab: -0.3439 | HV: 1.493568 | KL: 0.003574 [TR active] [10-step lag]
   [SB-TRPO] i= 160 | Safe: 11/20 | Valid: 11/20 | Grip: 1.3652 G | Stab: -0.3505 | HV: 1.496939 | KL: 0.002890 [TR active] [10-step lag]
   [SB-TRPO] i= 180 | Safe: 13/20 | Valid: 13/20 | Grip: 1.3719 G | Stab: -0.3760 | HV: 1.497577 | KL: 0.004117 [TR active] [10-step lag]
   [SB-TRPO] i= 200 | Safe: 11/20 | Valid: 11/20 | Grip: 1.3523 G | Stab: -0.3798 | HV: 1.498068 | KL: 0.003451 [TR active] [10-step lag]
   [SB-TRPO] i= 220 | Safe: 13/20 | Valid: 13/20 | Grip: 1.3677 G | Stab: -0.4033 | HV: 1.498068 | KL: 0.004088 [TR active] [10-step lag]
   [SB-TRPO] i= 240 | Safe: 11/20 | Valid: 11/20 | Grip: 1.3667 G | Stab: -0.3512 | HV: 1.499175 | KL: 0.004246 [TR active] [10-step lag]
   [SB-TRPO] i= 260 | Safe: 12/20 | Valid: 12/20 | Grip: 1.3579 G | Stab: -0.4024 | HV: 1.502083 | KL: 0.004822 [TR active] [10-step lag]
   [SB-TRPO] i= 280 | Safe: 12/20 | Valid: 12/20 | Grip: 1.3601 G | Stab: -0.3916 | HV: 1.502370 | KL: 0.004384 [TR active] [10-step lag]
   [SB-TRPO] i= 300 | Safe: 13/20 | Valid: 13/20 | Grip: 1.3587 G | Stab: -0.3708 | HV: 1.502682 | KL: 0.004617 [TR active] [10-step lag]
   [SB-TRPO] i= 320 | Safe: 12/20 | Valid: 12/20 | Grip: 1.3720 G | Stab: -0.3878 | HV: 1.502682 | KL: 0.004951 [TR active] [10-step lag]
   [SB-TRPO] i= 340 | Safe: 11/20 | Valid: 11/20 | Grip: 1.3702 G | Stab: -0.3758 | HV: 1.510873 | KL: 0.005017 [TR active] [10-step lag]
   [SB-TRPO] i= 360 | Safe: 12/20 | Valid: 12/20 | Grip: 1.3585 G | Stab: -0.3558 | HV: 1.510873 | KL: 0.005197 [TR active] [10-step lag]
   [SB-TRPO] i= 380 | Safe: 11/20 | Valid: 11/20 | Grip: 1.3641 G | Stab: -0.3853 | HV: 1.510894 | KL: 0.005436 [TR active] [10-step lag]

[MORL-SB-TRPO] Pareto front discovery complete:
         k_f          k_r      arb_f       arb_r         c_f         c_r     h_cg  brake_bias_f  Lat_G_Score  Stability_Overshoot  Generation
30864.777344 31874.328125 943.245239  442.435028 1834.236084 3367.583740 0.275343      0.646089     1.401121             1.508708          46
31050.427734 31704.228516 944.928650  441.380310 1829.293457 3354.196289 0.275419      0.645961     1.398303             1.735421          78
31059.132812 31698.835938 945.389832  441.369995 1825.748779 3353.557861 0.275443      0.646231     1.397961             2.038288          80
31215.199219 31572.722656 947.749146  438.806763 1823.565186 3359.461670 0.275516      0.645355     1.396474             2.075083         105
23862.253906 37671.796875 373.097473 1354.921997 3215.702637 2930.827637 0.282150      0.635530     1.396453             2.280055         123
23773.257812 37532.191406 373.818787 1353.870117 3247.620850 2956.197754 0.282160      0.635255     1.395395             2.331575           5
30897.853516 31844.751953 945.702087  440.969696 1826.277344 3365.336670 0.275452      0.646066     1.393971             2.399614          52
30763.082031 31971.503906 943.015076  442.701111 1831.250610 3370.382812 0.275342      0.646252     1.391653             3.129628          33
23847.929688 37646.859375 374.590546 1352.768677 3233.112061 2947.571289 0.282072      0.635263     1.387436             3.416893          58
23816.923828 37598.570312 373.078094 1354.932129 3222.538330 2933.757324 0.282223      0.635258     1.386486             3.709598          79
29711.355469 40731.480469 418.242188 1642.192139 4638.271484 4463.018555 0.293936      0.634361     1.385456             8.106288          82
29992.412109 40893.992188 420.902069 1642.262207 4601.175781 4428.351074 0.293942      0.634690     1.383156             8.571761         330
22803.791016 28327.605469 302.471405 1834.630615 5292.803711 4259.380371 0.277867      0.726678     1.383016            11.288790         390
22598.281250 28112.597656 304.530731 1834.005493 5306.286133 4302.519531 0.277843      0.726497     1.379448            14.211812         257
22726.644531 28128.792969 303.951233 1833.853516 5298.999512 4286.332031 0.277932      0.726649     1.375085            14.212671         308
22524.146484 27953.765625 302.414459 1835.004395 5315.768555 4335.521484 0.277788      0.726720     1.374173            14.674504         173
22580.814453 28096.746094 303.064087 1834.823853 5308.108398 4305.913086 0.277785      0.726571     1.368752            14.952225         254
22450.433594 27909.042969 304.537628 1833.890747 5324.736328 4342.684570 0.277896      0.726539     1.364113            15.598600         117
22415.980469 27814.517578 304.738739 1833.756714 5327.530762 4356.125977 0.277925      0.726534     1.363518            15.624714          88
22400.468750 27856.070312 303.691559 1834.443604 5331.673340 4367.875977 0.277821      0.726611     1.355801            16.102602          69
22448.996094 27827.591797 302.639740 1834.986938 5324.095703 4360.885742 0.277771      0.726711     1.355712            16.393730          95

[Success] Pareto array saved to /home/alexr/FS_Driver_Setup_Optimizer/morl_pareto_front.csv
