
============================================================
PHASE 4: DYNAMIC AI SETUP DISCOVERY (MORL-SB-TRPO)
============================================================

[MORL-SB-TRPO] Initialising Pareto Policy Ensemble…
[SB-TRPO] Compiling 46-DOF physics gradients via XLA…
   [DIAG] Soft grip: 1.3541 G | Hard grip: 1.3127 G
[SB-TRPO] Testing gradient flow through objective…
   Grip gradient norm : 0.311098
   Grip gradient max  : 0.247936
   [OK] Gradient flow confirmed — TRPO is active.
   [DIAG] Expected per-step KL at lr=3e-3, σ=0.368: ~0.000266 nats  (threshold=0.0005)
   [WARN] KL may still be below threshold — consider raising lr.
[SB-TRPO] Running feasibility pre-check…
   [SB-TRPO] i=   0 | Safe: 8/20 | Valid: 8/20 | Grip: 1.3639 G | Stab: -0.3835 | HV: 0.392575 | KL: 0.000000
   [SB-TRPO] i=  20 | Safe: 8/20 | Valid: 8/20 | Grip: 1.3872 G | Stab: -0.3559 | HV: 1.353741 | KL: -0.000000
   [SB-TRPO] i=  40 | Safe: 11/20 | Valid: 11/20 | Grip: 1.3952 G | Stab: -0.3434 | HV: 1.354533 | KL: -0.000000
   [SB-TRPO] i=  60 | Safe: 8/20 | Valid: 8/20 | Grip: 1.3890 G | Stab: -0.3737 | HV: 1.360954 | KL: -0.000000
   [SB-TRPO] i=  80 | Safe: 7/20 | Valid: 7/20 | Grip: 1.3564 G | Stab: -0.3805 | HV: 1.390605 | KL: -0.000000
   [SB-TRPO] i= 100 | Safe: 5/20 | Valid: 5/20 | Grip: 1.3729 G | Stab: -0.4216 | HV: 1.390985 | KL: -0.000000
   [SB-TRPO] i= 120 | Safe: 6/20 | Valid: 6/20 | Grip: 1.3703 G | Stab: -0.3951 | HV: 1.391026 | KL: -0.000000
   [SB-TRPO] i= 140 | Safe: 6/20 | Valid: 6/20 | Grip: 1.3632 G | Stab: -0.3531 | HV: 1.391178 | KL: -0.000000
   [SB-TRPO] i= 160 | Safe: 5/20 | Valid: 5/20 | Grip: 1.3721 G | Stab: -0.3563 | HV: 1.391383 | KL: 0.000000
   [SB-TRPO] i= 180 | Safe: 6/20 | Valid: 6/20 | Grip: 1.3820 G | Stab: -0.3855 | HV: 1.391383 | KL: 0.000000
   [SB-TRPO] i= 200 | Safe: 5/20 | Valid: 5/20 | Grip: 1.3689 G | Stab: -0.3689 | HV: 1.391383 | KL: -0.000000
   [SB-TRPO] i= 220 | Safe: 7/20 | Valid: 7/20 | Grip: 1.3649 G | Stab: -0.3884 | HV: 1.391383 | KL: -0.000000
   [SB-TRPO] i= 240 | Safe: 4/20 | Valid: 4/20 | Grip: 1.3547 G | Stab: -0.3550 | HV: 1.391416 | KL: -0.000000
   [SB-TRPO] i= 260 | Safe: 5/20 | Valid: 5/20 | Grip: 1.3696 G | Stab: -0.3324 | HV: 1.391799 | KL: -0.000000
   [SB-TRPO] i= 280 | Safe: 4/20 | Valid: 4/20 | Grip: 1.3620 G | Stab: -0.3808 | HV: 1.433678 | KL: -0.000000
   [SB-TRPO] i= 300 | Safe: 4/20 | Valid: 4/20 | Grip: 1.3635 G | Stab: -0.3688 | HV: 1.433678 | KL: -0.000000
   [SB-TRPO] i= 320 | Safe: 4/20 | Valid: 4/20 | Grip: 1.3719 G | Stab: -0.3811 | HV: 1.433678 | KL: -0.000000
   [SB-TRPO] i= 340 | Safe: 5/20 | Valid: 5/20 | Grip: 1.3748 G | Stab: -0.3651 | HV: 1.433678 | KL: -0.000000
   [SB-TRPO] i= 360 | Safe: 4/20 | Valid: 4/20 | Grip: 1.3552 G | Stab: -0.3634 | HV: 1.433678 | KL: -0.000000
   [SB-TRPO] i= 380 | Safe: 4/20 | Valid: 4/20 | Grip: 1.3626 G | Stab: -0.3736 | HV: 1.433784 | KL: -0.000000

[MORL-SB-TRPO] Pareto front discovery complete:
         k_f          k_r       arb_f       arb_r         c_f         c_r     h_cg  brake_bias_f  Lat_G_Score  Stability_Overshoot  Generation
31527.082031 31203.468750  998.809814  408.901855 1739.226074 3194.661377 0.277345      0.640505     1.397729             1.025817          53
30913.980469 31791.873047  968.898621  426.912537 1789.220337 3299.453369 0.276252      0.643177     1.397014             1.789261          24
23906.414062 37742.906250  379.518860 1345.467529 3235.589111 2943.375000 0.281767      0.634765     1.395553             2.302962           5
31995.046875 30764.800781 1020.645142  395.188507 1712.379883 3130.928955 0.278161      0.639391     1.394227             2.504235          72
31068.792969 31648.191406  976.685120  422.390472 1771.909668 3265.165771 0.276528      0.642200     1.393691             2.863510          33
27905.941406 32584.992188  492.057983 1001.470581 2515.552002 4217.401855 0.314096      0.656108     1.389966             3.364398         242
32044.177734 42907.000000  467.002136 1602.904419 4408.781250 4216.523926 0.289189      0.636528     1.383400             6.465910          82
30530.333984 41663.296875  442.783264 1621.378052 4574.425781 4390.720215 0.291864      0.635529     1.376370             8.121687          29
29996.355469 41098.062500  429.658691 1631.332397 4627.960938 4449.623535 0.293037      0.635378     1.374171             8.471713          11
31950.626953 42908.558594  465.020325 1604.658447 4418.569336 4226.537598 0.289147      0.636629     1.366293             8.957181          79
30999.542969 42081.523438  452.067017 1613.938599 4525.733398 4338.589844 0.290995      0.635766     1.348602             9.017570          45
35449.750000 51283.343750 1379.605591  642.489502 4958.850586 4831.506836 0.288808      0.545742     1.325492             9.158173          14
35679.351562 51423.929688 1388.452881  633.116516 4941.519531 4812.267090 0.288311      0.547089     1.302830             9.184338          21

[Success] Pareto array saved to /home/alexr/FS_Driver_Setup_Optimizer/morl_pareto_front.csv
