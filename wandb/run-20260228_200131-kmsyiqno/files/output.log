
============================================================
PHASE 4: DYNAMIC AI SETUP DISCOVERY (MORL-SB-TRPO)
============================================================
[VehicleDynamics] H_net scale loaded: 103.31 J
[Physics Engine] Loaded pre-trained H_net weights.
[Physics Engine] Loaded pre-trained R_net weights.

[MORL-SB-TRPO] Initialising Pareto Policy Ensemble…
[SB-TRPO] Compiling 46-DOF physics gradients via XLA…
   [DIAG] Soft grip: 1.5289 G | Hard grip: 1.4838 G
[SB-TRPO] Testing gradient flow through objective…
   Grip gradient norm : 0.533184
   [OK] Gradient flow confirmed — TRPO is active.
   [DIAG] Entropy bonus: coeff=0.0050 | At log_std=-1.0: Σ contribution = -0.0400 G-equiv per member
   [DIAG] At log_std=-3.0 (collapsed): -0.1200 G-equiv — resists collapse.
   [DIAG] KL: per-step≈0.000739, 10-step lag≈0.007389 (threshold=0.0005)
   [OK] Trust region activates after 10-iter burn-in.
   [Fix H] Chebyshev omegas: 8/20 members in high-grip region [0.7, 1.0] (vs 6 with linear spacing).
   [Fix B] Stability_Overshoot cap: 5.0 — artefact setups (k_f at boundary) will be filtered from archive.
   [Fix G] Population restart: every 200 iters, bottom 5 members reinitialised to random logit-space.
[SB-TRPO] Running feasibility pre-check…
   [SB-TRPO] i=   0 | Safe: 13/20 | Valid: 9/20 | Grip: 1.5112 G | Stab: -0.3666 | HV: 1.595736 | KL: 0.000000 | log_std: -0.998 [+5 artefacts filtered] [burn-in]
   [SB-TRPO] i=  20 | Safe: 15/20 | Valid: 11/20 | Grip: 1.5477 G | Stab: -0.3461 | HV: 1.753813 | KL: 0.002728 | log_std: -1.000 [+6 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i=  40 | Safe: 15/20 | Valid: 11/20 | Grip: 1.5645 G | Stab: -0.3351 | HV: 1.756351 | KL: 0.001989 | log_std: -0.997 [+6 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i=  60 | Safe: 13/20 | Valid: 8/20 | Grip: 1.5414 G | Stab: -0.3632 | HV: 1.766288 | KL: 0.002463 | log_std: -0.996 [+6 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i=  80 | Safe: 13/20 | Valid: 9/20 | Grip: 1.5756 G | Stab: -0.3669 | HV: 1.772611 | KL: 0.002298 | log_std: -0.997 [+4 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 100 | Safe: 14/20 | Valid: 10/20 | Grip: 1.5269 G | Stab: -0.4283 | HV: 1.773622 | KL: 0.002353 | log_std: -0.996 [+6 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 120 | Safe: 13/20 | Valid: 9/20 | Grip: 1.5195 G | Stab: -0.3883 | HV: 1.773622 | KL: 0.003026 | log_std: -0.993 [+6 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 140 | Safe: 13/20 | Valid: 9/20 | Grip: 1.5513 G | Stab: -0.3441 | HV: 1.776182 | KL: 0.003466 | log_std: -0.995 [+6 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 160 | Safe: 11/20 | Valid: 7/20 | Grip: 1.4791 G | Stab: -0.3504 | HV: 1.784253 | KL: 0.003012 | log_std: -0.995 [+6 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 180 | Safe: 13/20 | Valid: 9/20 | Grip: 1.5004 G | Stab: -0.3761 | HV: 1.784253 | KL: 0.003969 | log_std: -0.994 [+6 artefacts filtered] [TR active] [10-step lag]
   [FIX G] i=200: restarted bottom 5 members (grips: [np.float32(1.3428693), np.float32(1.3980942), np.float32(1.4055815), np.float32(1.4253734), np.float32(1.438202)])
   [SB-TRPO] i= 200 | Safe: 8/20 | Valid: 5/20 | Grip: 1.5280 G | Stab: -0.3798 | HV: 1.784587 | KL: 20.384916 | log_std: -0.994 [+5 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 220 | Safe: 10/20 | Valid: 7/20 | Grip: 1.5227 G | Stab: -0.4029 | HV: 1.785374 | KL: 0.005796 | log_std: -0.994 [+5 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 240 | Safe: 9/20 | Valid: 6/20 | Grip: 1.5435 G | Stab: -0.3512 | HV: 1.786278 | KL: 0.006045 | log_std: -0.994 [+6 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 260 | Safe: 9/20 | Valid: 6/20 | Grip: 1.4925 G | Stab: -0.4034 | HV: 1.789176 | KL: 0.006855 | log_std: -0.993 [+4 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 280 | Safe: 10/20 | Valid: 7/20 | Grip: 1.5016 G | Stab: -0.3926 | HV: 1.789178 | KL: 0.006895 | log_std: -0.993 [+3 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 300 | Safe: 11/20 | Valid: 8/20 | Grip: 1.5301 G | Stab: -0.3710 | HV: 1.789546 | KL: 0.006692 | log_std: -0.993 [+4 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 320 | Safe: 10/20 | Valid: 6/20 | Grip: 1.5052 G | Stab: -0.3877 | HV: 1.789546 | KL: 0.006830 | log_std: -0.994 [+7 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 340 | Safe: 8/20 | Valid: 4/20 | Grip: 1.4992 G | Stab: -0.3758 | HV: 1.799654 | KL: 0.006639 | log_std: -0.994 [+5 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 360 | Safe: 9/20 | Valid: 5/20 | Grip: 1.5064 G | Stab: -0.3561 | HV: 1.799654 | KL: 0.006961 | log_std: -0.994 [+5 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 380 | Safe: 8/20 | Valid: 5/20 | Grip: 1.4806 G | Stab: -0.3855 | HV: 1.799697 | KL: 0.007199 | log_std: -0.994 [+4 artefacts filtered] [TR active] [10-step lag]
   [FIX G] i=400: restarted bottom 5 members (grips: [np.float32(1.4425329), np.float32(1.4483247), np.float32(1.4490469), np.float32(1.4520426), np.float32(1.4540167)])
   [SB-TRPO] i= 400 | Safe: 10/20 | Valid: 7/20 | Grip: 1.5528 G | Stab: -0.3866 | HV: 1.799697 | KL: 24.147087 | log_std: -0.993 [+5 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 420 | Safe: 11/20 | Valid: 7/20 | Grip: 1.5313 G | Stab: -0.3722 | HV: 1.799697 | KL: 0.005161 | log_std: -0.993 [+6 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 440 | Safe: 11/20 | Valid: 8/20 | Grip: 1.5446 G | Stab: -0.3863 | HV: 1.799697 | KL: 0.005670 | log_std: -0.994 [+5 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 460 | Safe: 8/20 | Valid: 5/20 | Grip: 1.5098 G | Stab: -0.3985 | HV: 1.801032 | KL: 0.006353 | log_std: -0.993 [+5 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 480 | Safe: 10/20 | Valid: 7/20 | Grip: 1.5561 G | Stab: -0.3319 | HV: 1.801032 | KL: 0.005334 | log_std: -0.992 [+5 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 500 | Safe: 9/20 | Valid: 6/20 | Grip: 1.5283 G | Stab: -0.4067 | HV: 1.801032 | KL: 0.006059 | log_std: -0.994 [+4 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 520 | Safe: 9/20 | Valid: 7/20 | Grip: 1.4994 G | Stab: -0.3358 | HV: 1.802283 | KL: 0.006041 | log_std: -0.994 [+4 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 540 | Safe: 8/20 | Valid: 4/20 | Grip: 1.5256 G | Stab: -0.3768 | HV: 1.802283 | KL: 0.006599 | log_std: -0.993 [+6 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 560 | Safe: 10/20 | Valid: 6/20 | Grip: 1.5493 G | Stab: -0.3553 | HV: 1.802283 | KL: 0.006895 | log_std: -0.993 [+6 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 580 | Safe: 9/20 | Valid: 6/20 | Grip: 1.5338 G | Stab: -0.3613 | HV: 1.802283 | KL: 0.006756 | log_std: -0.993 [+6 artefacts filtered] [TR active] [10-step lag]
   [FIX G] i=600: restarted bottom 5 members (grips: [np.float32(1.4105029), np.float32(1.4251313), np.float32(1.4265971), np.float32(1.4302616), np.float32(1.4435891)])
   [SB-TRPO] i= 600 | Safe: 9/20 | Valid: 8/20 | Grip: 1.5231 G | Stab: -0.5915 | HV: 1.802283 | KL: 27.247129 | log_std: -0.992 [+4 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 620 | Safe: 10/20 | Valid: 7/20 | Grip: 1.5540 G | Stab: -0.9914 | HV: 1.802283 | KL: 0.005551 | log_std: -0.992 [+6 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 640 | Safe: 11/20 | Valid: 8/20 | Grip: 1.5202 G | Stab: -0.8924 | HV: 1.802283 | KL: 0.006951 | log_std: -0.994 [+4 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 660 | Safe: 10/20 | Valid: 6/20 | Grip: 1.5338 G | Stab: -0.5382 | HV: 1.802283 | KL: 0.007087 | log_std: -0.995 [+6 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 680 | Safe: 9/20 | Valid: 7/20 | Grip: 1.5443 G | Stab: -0.7974 | HV: 1.802283 | KL: 0.007251 | log_std: -0.995 [+4 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 700 | Safe: 9/20 | Valid: 6/20 | Grip: 1.5684 G | Stab: -0.9451 | HV: 1.802283 | KL: 0.007375 | log_std: -0.996 [+5 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 720 | Safe: 8/20 | Valid: 5/20 | Grip: 1.5257 G | Stab: -1.1546 | HV: 1.802425 | KL: 0.007619 | log_std: -0.996 [+5 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 740 | Safe: 9/20 | Valid: 6/20 | Grip: 1.5232 G | Stab: -1.1279 | HV: 1.802425 | KL: 0.007915 | log_std: -0.997 [+4 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 760 | Safe: 10/20 | Valid: 7/20 | Grip: 1.5330 G | Stab: -1.1092 | HV: 1.802425 | KL: 0.008098 | log_std: -0.998 [+4 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 780 | Safe: 9/20 | Valid: 7/20 | Grip: 1.5524 G | Stab: -1.2682 | HV: 1.802425 | KL: 0.007493 | log_std: -0.998 [+2 artefacts filtered] [TR active] [10-step lag]
   [FIX G] i=800: restarted bottom 5 members (grips: [np.float32(1.3869674), np.float32(1.400364), np.float32(1.4025365), np.float32(1.4196284), np.float32(1.4345276)])
   [SB-TRPO] i= 800 | Safe: 8/20 | Valid: 6/20 | Grip: 1.5267 G | Stab: -0.9984 | HV: 1.802425 | KL: 29.605494 | log_std: -1.001 [+6 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 820 | Safe: 10/20 | Valid: 8/20 | Grip: 1.5392 G | Stab: -0.9145 | HV: 1.802425 | KL: 0.006601 | log_std: -1.002 [+4 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 840 | Safe: 9/20 | Valid: 7/20 | Grip: 1.5358 G | Stab: -1.2049 | HV: 1.802425 | KL: 0.009061 | log_std: -1.003 [+4 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 860 | Safe: 8/20 | Valid: 6/20 | Grip: 1.5560 G | Stab: -1.3759 | HV: 1.802425 | KL: 0.008970 | log_std: -1.004 [+4 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 880 | Safe: 8/20 | Valid: 6/20 | Grip: 1.5234 G | Stab: -0.9198 | HV: 1.802425 | KL: 0.008537 | log_std: -1.005 [+4 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 900 | Safe: 8/20 | Valid: 6/20 | Grip: 1.5451 G | Stab: -0.6668 | HV: 1.802425 | KL: 0.008781 | log_std: -1.006 [+4 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 920 | Safe: 8/20 | Valid: 6/20 | Grip: 1.5222 G | Stab: -1.1452 | HV: 1.802425 | KL: 0.008120 | log_std: -1.006 [+4 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 940 | Safe: 9/20 | Valid: 7/20 | Grip: 1.5496 G | Stab: -1.1572 | HV: 1.802425 | KL: 0.007978 | log_std: -1.008 [+5 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 960 | Safe: 9/20 | Valid: 8/20 | Grip: 1.5311 G | Stab: -1.1786 | HV: 1.802425 | KL: 0.007402 | log_std: -1.008 [+4 artefacts filtered] [TR active] [10-step lag]
   [SB-TRPO] i= 980 | Safe: 8/20 | Valid: 6/20 | Grip: 1.5411 G | Stab: -0.9334 | HV: 1.802425 | KL: 0.007561 | log_std: -1.008 [+5 artefacts filtered] [TR active] [10-step lag]

[MORL-SB-TRPO] Pareto front discovery complete:
         k_f          k_r       arb_f       arb_r         c_f         c_r     h_cg  brake_bias_f  Lat_G_Score  Stability_Overshoot  Generation
30870.050781 31875.292969  943.420898  442.318787 1833.269043 3364.673096 0.275350      0.646099     1.576885             1.504664          46
31064.683594 31704.146484  945.192505  441.422272 1825.533936 3360.215576 0.275433      0.646202     1.575643             2.040650          80
31224.906250 31577.544922  949.054382  438.405029 1820.994507 3339.321289 0.275572      0.645528     1.569227             2.041804         105
41251.449219 45507.257812 1314.380493 1468.492676 4612.781250 3100.057373 0.258914      0.596385     1.568717             4.609200         825
40999.746094 45809.664062 1316.189941 1466.273438 4608.385254 3104.520752 0.258955      0.596436     1.568473             4.960353         502
41455.750000 45288.359375 1314.599854 1466.440674 4614.349609 3099.948730 0.258942      0.596388     1.541133             4.983209         980
37680.453125 39689.429688 1014.104736 1847.506104 4011.078613 3795.037109 0.281446      0.610610     1.536484             4.991041         286
37345.050781 39281.777344  353.593750  304.421722 4152.707520 3275.634521 0.306117      0.671402     1.501735             4.995352         255
30324.228516 40706.109375  417.424438 1642.496460 4575.458496 4403.111328 0.293908      0.634603     1.499088             4.999970         825

[Success] Pareto array saved to /home/alexr/FS_Driver_Setup_Optimizer/morl_pareto_front.csv
